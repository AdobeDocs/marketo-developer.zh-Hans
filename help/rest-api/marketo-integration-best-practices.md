---
title: Marketo集成最佳实践
feature: REST API
description: 使用Marketo API的最佳实践。
exl-id: 1e418008-a36b-4366-a044-dfa9fe4b5f82
source-git-commit: 66add4c38d0230c36d57009de985649bb67fde3e
workflow-type: tm+mt
source-wordcount: '952'
ht-degree: 0%

---

# Marketo集成最佳实践

## API限制

- **每日配额：**&#x200B;大多数订阅每天分配的API调用数为50,000（CST凌晨12:00重置）。 您可以通过客户经理增加每日配额。
- **速率限制：**&#x200B;每个实例的API访问限制为每20秒100次调用。
- **并发限制：**  最多十次并发API调用。
- **批次大小：**&#x200B;潜在客户数据库 — 300条记录；资产查询 — 200条记录
- **REST API有效负载大小：** 1MB
- **批量导入文件大小：** 10MB
- **SOAP最大批次大小：** 300条记录
- **批量提取作业：** 2正在执行；10个已排队（包含）

## 快速提示

- 假定您的应用程序将与其他应用程序竞争配额、速率和并发资源，并设置保守的使用量限制。
- 在适当时，请使用Marketo的批量方法和批处理方法。 仅在必要时使用单个记录或单个结果调用。
- 使用[指数回退](https://en.wikipedia.org/wiki/Exponential_backoff)重试由于速率或并发限制而失败的API调用。
- 如果您的用例不能从中受益，请避免进行并发API调用。

## 批处理

为确保集成获得最佳性能，在执行插入或更新时，应将记录分组为尽可能少的事务处理。 从数据存储中检索记录以供提交时，应始终在提交之前聚合记录，而不是针对每项单独更改提交请求。

## 可接受的延迟

确定延迟容差，或者在提交API调用之前可能经过的最大时间，将告知许多（如果不是大多数）您在设计与Marketo的集成时所做的决策。 Marketo提供了多种不同的方法和配置选项，它们适用于不同的用例和不同的延迟类。 例如，实时集成用于通知销售人员用户注册了试用，该集成可能仅在需要立即跟进时提交批次的试用。 但是，大多数情况下不需要此功能，并且可以容忍额外的延迟，并且可以通过排队和批处理呼叫来更有效地管理。

| 可接受的延迟 | 首选方法 | 备注 |
|---|---|---|
| 低（&lt;10秒） | 同步API（批处理或未批处理） | 确保您的用例需要此项。 发送针对高容量用例的即时和同步调用可能会快速占用每日API配额，并且可能超过速率和并发限制。 |
| Medium（1000万 — 6000万） | 同步API（批处理） | 对于与Marketo的入站数据集成，强烈建议使用具有时限和大小限制的队列。 当达到任一限制时，请刷新队列并使用累积记录提交API请求。 这在速度和效率之间实现了强有力的折衷，确保您的请求以所需的节奏发生，同时按队列的保留时间允许的数量批处理记录。 |
| 高（>60米） | 批量导入/导出（如果支持） | 对于入站数据集成，应通过Marketo批量API（在可用时）对记录进行排队和提交。 |

## 每日限制

Marketo每个启用API的实例每天至少分配10,000个REST API调用，但通常为50,000个或更多，以及500 MB或更多的批量提取容量。 虽然可以将额外的每日容量作为Marketo订阅的一部分购买，但您的应用程序设计应考虑Marketo订阅的常见限制。

由于在一个实例中容量由所有API服务和用户共享，因此最佳做法是消除多余调用，并将记录批量处理为尽可能少的调用。 导入记录的最有效调用方法是使用Marketo的批量导入API，这些API可用于[潜在客户/人员](https://developer.adobe.com/marketo-apis/api/mapi/#tag/Bulk-Import-Leads/operation/importLeadUsingPOST)和[自定义对象](https://developer.adobe.com/marketo-apis/api/mapi/#tag/Snippets/operation/createSnippetUsingPOST)。 Marketo还为[潜在客户](bulk-lead-extract.md)和[活动](bulk-activity-extract.md)提供批量提取。

### 缓存

以下操作的结果通常可以在客户端缓存一天或更长时间，因为它们很少更改：

- Describe操作的结果
- [活动类型](https://developer.adobe.com/marketo-apis/api/mapi/#tag/Activities/operation/getAllActivityTypesUsingGET)
- [分区](https://developer.adobe.com/marketo-apis/api/mapi/#tag/Leads/operation/getLeadPartitionsUsingGET)

缓存某些资产类型（如程序、电子邮件和文件夹）也适合某些用例，例如潜在客户或活动记录的数据扩充。

## 速率限制

每个Marketo实例的速率限制为每20秒100次调用，该速率限制在所有第三方API服务之间共享。 如果超过此限制，API将使用606错误代码进行响应，指示已超过速率限制。 通常，第三方集成应将其利用率限制为每20秒使用50次调用或更少，以允许多个API集成和用户公平使用速率限制。 尽管在某些情况下可能适合使这一限制饱和，但一般而言，使用批处理并将其吞吐量目标定在低于此限制的应用程序在操作中更加响应和一致，而增加等待时间的成本很低。

## 并发限制

每个Marketo实例都有一个共享限制，即同时执行REST API调用最多只能有10个。 与每日配额和速率限制一样，它也是共享的，因此您不应假定您的应用程序将是此限制的独占使用者。 Marketo将并发调用的数量计入正在处理且尚未返回的调用数，因此当调用返回时，不再将调用数计入并发调用数限制。

大多数集成用例不会受益于并发调用，因此在决定向Marketo提交并发请求之前，请考虑您的应用程序是否受益。 如果您确实希望实施并发，则应在初始设计中将并发请求数限制为5个或更少，并在确定应用程序需要更多并发请求后才增加此数量。

## 错误数

除少数少数情况外，API请求返回HTTP状态代码200。 业务逻辑错误也返回200，但在响应正文中包含详细信息。 有关详细说明，请参阅[错误代码](error-codes.md)。 不应评估HTTP原因短语，因为它是可选的且可能会发生变化。
